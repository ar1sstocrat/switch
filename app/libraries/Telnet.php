<?php/*php_telnet 1.1.1by Antone Roundyadapted from code found on the PHP websitepublic domain*/class Telnet {	var $show_connect_error=1;	var $use_usleep=0;	// change to 1 for faster execution		// don't change to 1 on Windows servers unless you have PHP 5	var $sleeptime=125000;	var $loginsleeptime=1000000;	var $fp=NULL;	var $loginprompt;	var $conn1;	var $conn2;		/*	0 = success	1 = couldn't open network connection	2 = unknown host	3 = login failed	4 = PHP version too low	*/        	function connect($server,$user = NULL, $pass = NULL) {		$rv=0;		$vers=explode('.',PHP_VERSION);		$needvers=array(4,3,0);		$j=count($vers);		$k=count($needvers);		if ($k<$j) $j=$k;		for ($i=0;$i<$j;$i++) {			if (($vers[$i]+0)>$needvers[$i]) break;			if (($vers[$i]+0)<$needvers[$i]) {				$this->connect_error(4);				return 4;			}		}				$this->disconnect();				if (strlen($server)) {			if (preg_match('/[^0-9.]/',$server)) {				$ip=gethostbyname($server);				if ($ip==$server) {					$ip='';					$rv=2;				}			} else $ip=$server;		} else $ip='127.0.0.1';				if (strlen($ip)) {			if ($this->fp=fsockopen($ip,23)) {				fputs($this->fp,$this->conn1);				$this->sleep();								fputs($this->fp,$this->conn2);				$this->sleep();				$this->get_response($r);				$r=explode("\n",$r);				$this->loginprompt=$r[count($r)-1];                                if($user)                                {                                    fputs($this->fp,"$user\r");                                    $this->sleep();                                }                                if($pass) fputs($this->fp,"$pass\r");				if ($this->use_usleep) usleep($this->loginsleeptime);				else sleep(1);				$this->get_response($r);				$r=explode("\n",$r);				if (($r[count($r)-1]=='')||($this->loginprompt==$r[count($r)-1])) {					$rv=3;					$this->disconnect();				}			} else $rv=1;		}				if ($rv) $this->connect_error($rv);		return $rv;	}		function disconnect($exit=1) {		if ($this->fp) {			if ($exit) $this->command_line('quit',$junk);			fclose($this->fp);			$this->fp=NULL;		}	}	function command_line($c,&$r) {		if ($this->fp) {			fputs($this->fp,"$c\r");			$this->sleep();			$this->get_response($r);			$r=preg_replace("/^.*?\n(.*)\n[^\n]*$/","$1",$r);		}		return $this->fp?1:0;	}		function get_response(&$r) {		$r='';		do { 			$r.=fread($this->fp,1000);			$s=socket_get_status($this->fp);		} while ($s['unread_bytes']);	}		function sleep() {		if ($this->use_usleep) usleep($this->sleeptime);		else sleep(1);	}		function php_telnet() {		$this->conn1=chr(0xFF).chr(0xFB).chr(0x1F).chr(0xFF).chr(0xFB).			chr(0x20).chr(0xFF).chr(0xFB).chr(0x18).chr(0xFF).chr(0xFB).			chr(0x27).chr(0xFF).chr(0xFD).chr(0x01).chr(0xFF).chr(0xFB).			chr(0x03).chr(0xFF).chr(0xFD).chr(0x03).chr(0xFF).chr(0xFC).			chr(0x23).chr(0xFF).chr(0xFC).chr(0x24).chr(0xFF).chr(0xFA).			chr(0x1F).chr(0x00).chr(0x50).chr(0x00).chr(0x18).chr(0xFF).			chr(0xF0).chr(0xFF).chr(0xFA).chr(0x20).chr(0x00).chr(0x33).			chr(0x38).chr(0x34).chr(0x30).chr(0x30).chr(0x2C).chr(0x33).			chr(0x38).chr(0x34).chr(0x30).chr(0x30).chr(0xFF).chr(0xF0).			chr(0xFF).chr(0xFA).chr(0x27).chr(0x00).chr(0xFF).chr(0xF0).			chr(0xFF).chr(0xFA).chr(0x18).chr(0x00).chr(0x58).chr(0x54).			chr(0x45).chr(0x52).chr(0x4D).chr(0xFF).chr(0xF0);		$this->conn2=chr(0xFF).chr(0xFC).chr(0x01).chr(0xFF).chr(0xFC).			chr(0x22).chr(0xFF).chr(0xFE).chr(0x05).chr(0xFF).chr(0xFC).chr(0x21);	}		function connect_error($num) {		if ($this->show_connect_error) switch ($num) {		case 1: echo '<br />[PHP Telnet] <a href="http://www.geckotribe.com/php-telnet/errors/fsockopen.php">Connect failed: Unable to open network connection</a><br />'; break;		case 2: echo '<br />[PHP Telnet] <a href="http://www.geckotribe.com/php-telnet/errors/unknown-host.php">Connect failed: Unknown host</a><br />'; break;		case 3: echo '<br />[PHP Telnet] <a href="http://www.geckotribe.com/php-telnet/errors/login.php">Connect failed: Login failed</a><br />'; break;		case 4: echo '<br />[PHP Telnet] <a href="http://www.geckotribe.com/php-telnet/errors/php-version.php">Connect failed: Your server\'s PHP version is too low for PHP Telnet</a><br />'; break;		}	}                /*Function to switching Elcon*/                public function init_port($port_num = 0)        {            switch($port_num)            {                case 0: //OFF                    $this->command_line('pst 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 1:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 2:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 3:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 4:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 5:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 6:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 7:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 8:                    $this->command_line('pcl 5', $test);                    $this->command_line('pcl 4', $test);                    $this->command_line('pcl 3', $test);                    $this->command_line('pst 2', $test);                    $this->command_line('pst 1', $test);                    $this->command_line('pst 0', $test);                    break;                                case 9:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 10:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 11:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 12:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 13:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 14:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 15:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 16:                    $this->command_line('pcl 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 17:                    $this->command_line('pcl 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 18:                    $this->command_line('pcl 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 19:                    $this->command_line('pcl 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 20:                    $this->command_line('pcl 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 21:                    $this->command_line('pcl 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 22:                    $this->command_line('pcl 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 23:                    $this->command_line('pcl 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 24:                    $this->command_line('pcl 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 25:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 26:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 27:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 28:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 29:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 30:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 31:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 32:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 33:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 34:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 35:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 36:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 37:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 38:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 39:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 40:                    $this->command_line('pst 5', $r);                    $this->command_line('pcl 4', $r);                    $this->command_line('pst 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 41:                    $this->command_line('pst 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 42:                    $this->command_line('pst 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 43:                    $this->command_line('pst 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 44:                    $this->command_line('pst 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pcl 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 45:                    $this->command_line('pst 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 46:                    $this->command_line('pst 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pcl 1', $r);                    $this->command_line('pst 0', $r);                    break;                                case 47:                    $this->command_line('pst 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pcl 0', $r);                    break;                                case 48:                    $this->command_line('pst 5', $r);                    $this->command_line('pst 4', $r);                    $this->command_line('pcl 3', $r);                    $this->command_line('pst 2', $r);                    $this->command_line('pst 1', $r);                    $this->command_line('pst 0', $r);                    break;            }        }}return;?>